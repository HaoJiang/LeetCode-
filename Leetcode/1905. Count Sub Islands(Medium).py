from typing import List


class Solution:
    ### dfs
    def countSubIslands(self, grid1: List[List[int]], grid2: List[List[int]]) -> int:
        m = len(grid1)
        n = len(grid1[0])
        move = ((0, 1), (0, -1), (1, 0), (-1, 0))
        res = 0

        def dfs(x: int, y: int, ck: bool) -> bool:
            grid2[x][y] = 2
            if not grid1[x][y] and ck:
                ck = False
            for _x, _y in move:
                temp_x = x + _x
                temp_y = y + _y
                if m > temp_x >= 0 and n > temp_y >= 0 and grid2[temp_x][temp_y] == 1:
                    ck = dfs(temp_x, temp_y, ck)
            return ck

        for i in range(m):
            for j in range(n):
                if grid2[i][j] == 1 and dfs(i, j, True):
                    res += 1

        return res

    ### BFS
    def countSubIslands1(self, grid1: List[List[int]], grid2: List[List[int]]) -> int:
        from collections import deque
        m, n = len(grid1), len(grid1[0])

        def bfs(sx: int, sy: int) -> int:
            q = deque([(sx, sy)])
            # 判断岛屿包含的每一个格子是否都在 grid1 中出现了
            grid2[sx][sy] = 0
            check = True
            while q:
                x, y = q.popleft()

                if not grid1[x][y] and check:
                    check = False
                for nx, ny in ((x - 1, y), (x + 1, y), (x, y - 1), (x, y + 1)):
                    if 0 <= nx < m and 0 <= ny < n and grid2[nx][ny] == 1:
                        grid2[nx][ny] = 0
                        q.append((nx, ny))
            return check

        ans = 0
        for i in range(m):
            for j in range(n):
                if grid2[i][j] == 1 and bfs(i, j):
                    ans += 1
        return ans


if __name__ == '__main__':
    print(Solution().countSubIslands1(
        [[1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1,
          1, 0, 1, 0, 1, 1],
         [0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0,
          1, 1, 1, 1, 0, 0],
         [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1],
         [0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1,
          1, 1, 0, 0, 1, 0],
         [1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0,
          1, 1, 1, 1, 1, 1],
         [0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0,
          0, 1, 0, 1, 1, 1],
         [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0,
          1, 0, 0, 1, 0, 1],
         [1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
          1, 0, 1, 1, 1, 0],
         [1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1,
          1, 1, 0, 1, 1, 1],
         [1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1,
          1, 1, 1, 1, 1, 1],
         [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1],
         [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 0, 1, 1, 0],
         [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0,
          0, 1, 0, 1, 0, 1],
         [1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1],
         [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1,
          1, 1, 1, 0, 1, 0],
         [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1,
          1, 0, 1, 1, 1, 0],
         [1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 0, 1, 1, 1, 1],
         [1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1,
          1, 1, 1, 1, 1, 1],
         [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1,
          1, 1, 1, 1, 1, 1]],
        [[1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0,
          0, 1, 1, 0, 1, 0], [0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
                              0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1], [0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0,
                                                                       0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1,
                                                                       1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1], [1, 0, 0, 0, 1,
                                                                                                          1, 1, 1, 1, 1,
                                                                                                          0, 0, 0, 1, 1,
                                                                                                          1, 1, 1, 0, 1,
                                                                                                          0, 0, 1, 0, 1,
                                                                                                          1, 0, 1, 0, 0,
                                                                                                          0, 1, 0, 0, 1,
                                                                                                          0, 1, 1, 0, 0,
                                                                                                          1, 1, 0], [1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0],
         [
             1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1,
             1, 1, 0, 1, 0, 1, 1], [1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1,
                                    1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0,
                                                                                   0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                                                                   0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1,
                                                                                   0, 1, 0, 1, 1, 0, 1], [1, 1, 0, 1, 1,
                                                                                                          1, 1, 1, 1, 0,
                                                                                                          1, 0, 0, 1, 0,
                                                                                                          1, 1, 1, 0, 0,
                                                                                                          1, 1, 0, 0, 1,
                                                                                                          0, 1, 1, 0, 1,
                                                                                                          0, 1, 1, 0, 1,
                                                                                                          1, 0, 1, 0, 0,
                                                                                                          0, 0, 1], [0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0],
         [
             1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1,
             1, 1, 0, 0, 1, 1, 1], [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                                    1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1,
                                                                                   0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1,
                                                                                   0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0,
                                                                                   1, 1, 0, 1, 1, 0, 1], [1, 1, 1, 0, 1,
                                                                                                          1, 0, 1, 1, 0,
                                                                                                          1, 0, 1, 1, 1,
                                                                                                          0, 1, 0, 0, 1,
                                                                                                          1, 0, 1, 1, 1,
                                                                                                          1, 1, 0, 0, 0,
                                                                                                          1, 1, 1, 1, 1,
                                                                                                          0, 1, 0, 0, 1,
                                                                                                          1, 0, 1], [0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     0,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1,
                                                                                                                     1],
         [
             1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1,
             0, 1, 1, 1, 1, 1, 1], [1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0,
                                    1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1], [0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1,
                                                                                   1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0,
                                                                                   1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1,
                                                                                   1, 0, 1, 1, 0, 0, 1], [1, 1, 1, 1, 1,
                                                                                                          1, 1, 1, 1, 1,
                                                                                                          0, 1, 1, 0, 0,
                                                                                                          1, 1, 1, 1, 0,
                                                                                                          0, 1, 0, 1, 1,
                                                                                                          1, 0, 1, 1, 1,
                                                                                                          1, 0, 1, 1, 0,
                                                                                                          1, 1, 1, 1, 1,
                                                                                                          1, 1, 0]]))
